var http = require('http');
var fs = require('fs');
var url = require("url");
var querystring = require('querystring');

exports.start = function(port)
{
    fs.readFile('./index.html', function (err, html) {
        if (err)
        {
            return console.log('Error: Critical failure');
        }
        http.createServer(function(request, response) {
            var params = querystring.parse(url.parse(request.url).query);
            if ('name' in params)
            {
                response.writeHead(200, {"Content-Type": "text/html"});
                var result = String(html).replace("Traveller", params['name']);
                response.write(result);
            }
            else
            {
                response.writeHead(200, {"Content-Type": "text/html"});
                response.write(html);
            }
            response.end();
        }).listen(port);
        console.log('Server started on port : '+port);
    });
}
